(function (a) { function c(b) { e(b); var c = 0; var d = 0; var f = 0; var g = '<form action="https://www.paypal.com/uk/cgi-bin/webscr" method="post">\r\n'; g += '<input type="hidden" name="cmd" value="_cart" />\r\n'; g += '<input type="hidden" name="upload" value="1" />\r\n'; g += '<input type="hidden" name="currency_code" value="' + b.settings.currency + '" />\r\n'; g += '<input type="hidden" name="business" value="' + b.settings.business + '" />\r\n'; if (b.settings.virtual) { g += '<input type="hidden" name="no_shipping" value="1">\r\n' } if (b.settings.notifyURL != "") { g += '<input type="hidden" name="notify_url" value="' + b.settings.notifyURL + '" />\r\n' } g += '<table class="PayPalCart">\r\n'; g += '<tr><th> </th><th align="left">Description</th><th align="center">Qty</th><th align="right">Price</th></tr>\r\n'; for (var h = 0; h < b.settings.cartItems.length; h++) { c += b.settings.cartItems[h]["quantity"] * b.settings.cartItems[h]["value"]; d += b.settings.cartItems[h]["quantity"] * b.settings.cartItems[h]["tax"]; f += parseInt(b.settings.cartItems[h]["quantity"]); g += '<tr>\r\n<td><a href="javascript:void(0)" onclick="$(\'#' + b.id + "').PayPalCart('remove', '" + b.settings.cartItems[h]["code"] + "');\">x</a>\r\n"; g += '<input type="hidden" name="item_number_' + (h + 1).toString() + '" value="' + b.settings.cartItems[h]["code"] + '" />\r\n'; g += '<input type="hidden" name="item_name_' + (h + 1).toString() + '" value="' + b.settings.cartItems[h]["description"] + '" />\r\n'; g += '<input type="hidden" name="quantity_' + (h + 1).toString() + '" value="' + b.settings.cartItems[h]["quantity"] + '" />\r\n'; g += '<input type="hidden" name="amount_' + (h + 1).toString() + '" value="' + b.settings.cartItems[h]["value"] + '" />\r\n'; g += '<input type="hidden" name="tax_' + (h + 1).toString() + '" value="' + b.settings.cartItems[h]["tax"] + '" />\r\n'; g += "</td>\r\n"; g += '<td align="left">' + b.settings.cartItems[h]["description"] + "</td>\r\n"; if (b.settings.quantityupdate) { g += '<td align="center"><input type="text" size="2" name="' + b.settings.cartItems[h]["code"] + '" value="' + b.settings.cartItems[h]["quantity"] + '" onblur="$(\'#' + b.id + "').PayPalCart('update','" + b.settings.cartItems[h]["code"] + "', $(this).val());\" /></td>\r\n" } else { g += '<td align="center">' + b.settings.cartItems[h]["quantity"] + "</td>\r\n" } g += '<td align="right">' + b.settings.currencysign + parseFloat(b.settings.cartItems[h]["value"]).toFixed(2) + "</td></tr>\r\n" } g += '<tr class="PayPalCartTotals"><td colspan="3" align="left">Subtotal</td><td align="right">' + b.settings.currencysign + parseFloat(c).toFixed(2) + "</td></tr>\r\n"; g += '<tr class="PayPalCartTotals"><td colspan="3" align="left">Vat</td><td align="right">' + b.settings.currencysign + parseFloat(d).toFixed(2) + "</td></tr>\r\n"; g += '<tr class="PayPalCartTotals"><td colspan="3" align="left">Total</td><td align="right">' + b.settings.currencysign + parseFloat(c + d).toFixed(2) + "</td></tr>\r\n"; g += '<tr><td colspan="4" align="right"><input type="submit" value="Buy Now"></td></tr>\r\n'; g += "</table>\r\n"; g += "</form>\r\n"; a(b).html(g).ready(function () { a(this).find("input").keypress(function (c) { if (c.which == 13) { var d = a(this).attr("name"); var e = a(this).val(); a(b).PayPalCart("update", d, e); return false } }) }); if (b.settings.minicartid != "") { var i = ""; i += f.toString() + " items<br />" + b.settings.currencysign + parseFloat(c).toFixed(2); a("#" + b.settings.minicartid).html(i) } } function d(a) { var b = f("cart" + a.id); if (b != null && b != "") { var c = 0; for (i = 1; i <= b; i++) { var d = f("cart" + a.id + i); if (d != null && d != "") { var e = Array(); ARRline = d.split("##"); for (j = 0; j < ARRline.length; j++) { var g = ARRline[j].substr(0, ARRline[j].indexOf("=")).replace(/^\s+|\s+$/g, ""); var h = ARRline[j].substr(ARRline[j].indexOf("=") + 1); e[g] = h } a.settings.cartItems.push(e); c++ } } } } function e(a) { ARRcookies = document.cookie.split(";"); for (b = 0; b < ARRcookies.length; b++) { if (ARRcookies[b].substr(0, ARRcookies[b].indexOf("=")).indexOf("cart" + a.id) == 0) { g(ARRcookies[b].substr(0, ARRcookies[b].indexOf("=")), "", 0) } } if (a.settings.persistdays >= 0) { g("cart" + a.id, a.settings.cartItems.length, a.settings.persistdays); for (var b = 0; b < a.settings.cartItems.length; b++) { var c = ""; for (var d in a.settings.cartItems[b]) { if (c != "") c += "##"; c += d + "=" + a.settings.cartItems[b][d] } g("cart" + a.id + (b + 1).toString(), c, a.settings.persistdays) } } } function f(a) { var b, c, d, e = document.cookie.split(";"); for (b = 0; b < e.length; b++) { c = e[b].substr(0, e[b].indexOf("=")); d = e[b].substr(e[b].indexOf("=") + 1); c = c.replace(/^\s+|\s+$/g, ""); if (c == a) { return unescape(d) } } return "" } function g(a, b, c) { if (c > 0) { var d = new Date; d.setDate(d.getDate() + c); var e = escape(b) + (c == null ? "" : "; expires=" + d.toUTCString()); document.cookie = a + "=" + e } else { document.cookie = a + "=" + escape(b) } } var b = { init: function (b) { return this.each(function () { var e = { currency: "GBP", currencysign: "", business: "", virtual: false, quantityupdate: true, notifyurl: "", minicartid: "", persistdays: 0 }; this.settings = a.extend(e, b, { cartItems: new Array }); if (this.settings.persistdays >= 0) d(this); c(this) }) }, add: function (a, b, d, e, f) { return this.each(function () { var g = false; var h = this.settings.cartItems.length; for (var i = 0; i < h; i++) { if (this.settings.cartItems[i]["code"] == a) { this.settings.cartItems[i]["quantity"] = parseInt(this.settings.cartItems[i]["quantity"]) + parseInt(d); g = true } } if (!g) { this.settings.cartItems.push({ code: a, description: b, quantity: d, value: e, tax: f }) } c(this) }) }, remove: function (a) { return this.each(function () { var b = this.settings.cartItems.length; var d = new Array; for (var e = 0; e < b; e++) { if (this.settings.cartItems[e]["code"] != a) { d.push(this.settings.cartItems[e]) } } this.settings.cartItems = d; c(this) }) }, update: function (a, b) { return this.each(function () { var d = this.settings.cartItems.length; for (var e = 0; e < d; e++) { if (this.settings.cartItems[e]["code"] == a) { this.settings.cartItems[e]["quantity"] = parseInt(b) } } c(this) }) } }; a.fn.PayPalCart = function (c) { if (b[c]) { return b[c].apply(this, Array.prototype.slice.call(arguments, 1)) } else if (typeof c === "object" || !c) { return b.init.apply(this, arguments) } else { a.error("Method " + c + " does not exist on jQuery.tooltip") } } })(jQuery)